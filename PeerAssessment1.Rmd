---
title: "Reproducible Research: Peer Assessment 1"
author: "Melissa Pearson"
date: "1/9/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

## Loading and preprocessing the data

Create data folder in working directory if it does not exist, then access and download the data into this folder
```{r}
if(!file.exists("data")){dir.create("data")}
zipurl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
destzip <- "./data/activitydata.zip"
destfile <- "./data/activitydata"
download.file(url=zipurl, destfile=destzip, method='curl')
unzip(destzip,exdir=destfile)
```


Load R libraries for use
```{r}
library(dplyr)
library(ggplot2)
```

Load the data from the local data file into a data frame to use, and convert to tibble
```{r}
fname <- "./data/activitydata/activity.csv"
activity <- read.csv(fname)
activity <- tbl_df(activity)
```

## What is mean total number of steps taken per day?
1. Calculate the total number of steps taken per day
```{r}
aday <- activity %>% filter(!is.na(steps)) %>% group_by(date) %>% summarize(m = mean(steps))
```

2. Make a histogram of the total number of steps taken each day
```{r}
ggplot(aday, aes(m)) + geom_histogram()
```

3. Calculate and report the mean and median of the total number of steps taken per day
```{r}
totalmean <- mean(aday$m)
totalmed <- median(aday$m)
```
  
  The mean number of steps for all dates: `r totalmean`  
  The median number of steps for all dates: `r totalmed`

## What is the average daily activity pattern?
1. Make a time series plot (i.e. 𝚝𝚢𝚙𝚎 = "𝚕") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
atype <- activity %>% filter(!is.na(steps)) %>% group_by(interval) %>% summarize(m = mean(steps))
#insure interval is treated as a factor
atype$interval <- as.factor(atype$interval)
ggplot(atype, aes(x=interval, y=m)) + geom_point() + labs(x = "steps interval", y = "mean steps during interval", title = "mean steps per interval over testing period")
```

2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
amax <- atype[which.max(atype$m),]
maxinterval <- amax$interval
```

On average, **interval `r maxinterval`** has the maximum number of steps

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
